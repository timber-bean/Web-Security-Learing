# SQLi 漏洞

> 有人说互联网是由人组成的，也有人说互联网是由代码组成的。如果说互联网是由代码组成的，那么Web前端代码占据着互联网至少半壁江山；如果说互联网是由人组成的，那么有人的地方就有江湖，江湖中总是有剑客高手，互联网中也总是有技术黑客高手。	-《Web前端黑客技术揭秘》

Web 前端安全只包含了一部分内容，例如 XSS、CSRF、界面操作劫持等。然而，Web 安全不止有前端，还有后端，例如 SQLi、SSTI、SSRF 等。本笔记旨在记录学习 Web 安全期间，遇到的重要基础知识及重点难点。

当然，Web 安全除了需要扎实的基础知识外，还需要 Web 安全人员不断的学习新知识，紧跟时下热点漏洞，与时俱进。



## 总述

* SQLi 漏洞 -- 与数据库有关

* XSS（跨站脚本攻击）漏洞

* SSRF（服务端请求伪造）漏洞

* CSRF（跨站请求伪造）漏洞

* SSTI（服务器端模板注入）漏洞 -- 与 python 有关

* PHP 相关

* 一些名词

  

## 形成原因

### SQLi 漏洞

开发人员在开发过程中，直接将 URL 中的参数、HTTP Body 中的 POST 参数或其他外来的用户输入（如 Cookie，User-Agent 等）与 SQL 语句进行拼接，造成待执行的 SQL 语句可控，从而使攻击者可以执行任意 SQL 语句。



### XSS 漏洞

XSS 即跨站脚本（Cross Site Scripting），发生在目标网站中目标用户的浏览器层面上，当用户浏览器渲染整个 HTML 文档的过程中，出现了非预期的脚本指令并执行时，XSS 就会发生。它是一种经常出现在 WEB 应用程序中的安全漏洞，是由于 WEB 应用程序对用户的输入过滤不足而产生的。攻击者利用网站漏洞把恶意的脚本代码注入到网页中，当其他用户浏览这些网页时，就会执行其中的恶意代码，对受害用户可能采取 Cookies 资料窃取、会话劫持、钓鱼欺骗等各种攻击。



### SSRF 漏洞

SSRF 即服务端请求伪造（Server-side Request Forgery），大都是由于服务端提供了从其他服务器或应用中获取数据的功能，但没有对目标地址做出有效的过滤与限制造成的。它是一种由攻击者构造形成由服务器端发起请求的一个漏洞。一般情况下，SSRF 攻击的目标是从外网无法访问的内部系统。

攻击者可以利用 SSRF 实现的攻击主要有 5 种：

1. 可以对外网、服务器所在内网、本地进行端口扫描，获取一些服务的 banner 信息
2. 攻击运行在内网或本地的应用程序（比如溢出）
3. 对内网 WEB 应用进行指纹识别，通过访问默认文件实现
4. 攻击内外网的 web 应用，主要是使用 GET 参数就可以实现的攻击（比如 Struts2，sqli 等）
5. 利用 file 协议读取本地文件等



### CSRF 漏洞

CSRF 则是客户端请求伪造（Cross-Request Forgery），攻击者利用该漏洞可以劫持其他用户去进行一些请求。很容易将它与 XSS 混淆，对于 CSRF，其两个关键点是跨站点的请求与请求的伪造，如果目标站无 token 或 referrer 防御，那么用户的敏感操作的每一个参数都可以被攻击者获知，攻击者即可以伪造一个完全一样的请求以用户的身份达到恶意目的。CSRF 对于大多数闭源开发的网站来说，危害性很小，因为，攻击者并不了解后台的情况，很难加以利用。而对于开源的网站，攻击者可以利用 CSRF 漏洞直接攻击管理员后台。



### SSTI 漏洞

SSTI 就是服务器端模板注入（Server-Side Template Injection），它通过与服务端模板的输入输出交互，在过滤不严格的情况下，攻击者可以构造恶意输入数据，从而达到读取文件或者 getshell 的目的。SSTI 也是获取了一个输入，然后在后端的渲染处理上进行了语句的拼接，然后执行。当然还是和 sqli 有所不同的，SSTI 利用的是现在的网站模板引擎，主要针对 python、php、java 的一些网站处理框架，比如 Python 的 jinja2, mako, tornado, django，php 的 smarty, twig，java的jade, velocity。当这些框架对运用渲染函数生成 html 的时候会出现 SSTI 的问题。



### PHP 相关

与 PHP 相关的漏洞，大部分都是由于 PHP 语言本身或是网站搭建者对 PHP 中的函数理解不深刻而误用导致的，其中包括文件上传、文件包含、变量覆盖、命令执行以及 PHP 相关的一些特性。



### 一些名词

Web 安全中，常用的一些专有名词，会记录其名字及含义。